

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ebu_tt_live.bindings &mdash; EBU-TT-Live Toolkit 2.1.3 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> EBU-TT-Live Toolkit
          

          
          </a>

          
            
            
              <div class="version">
                2.1.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview of the EBU-TT live toolkit.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ebu_tt_live.html">Source code reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EBU-TT-Live Toolkit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>ebu_tt_live.bindings</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for ebu_tt_live.bindings</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">.raw</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">raw</span>

<span class="c1"># Let&#39;s import customizations</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_ebuttdt</span> <span class="k">as</span> <span class="n">ebuttdt</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_ebuttm</span> <span class="k">as</span> <span class="n">ebuttm</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_ebuttlm</span> <span class="k">as</span> <span class="n">ebuttlm</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_ebuttp</span> <span class="k">as</span> <span class="n">ebuttp</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_ebutts</span> <span class="k">as</span> <span class="n">ebutts</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_ttm</span> <span class="k">as</span> <span class="n">ttm</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_ttp</span> <span class="k">as</span> <span class="n">ttp</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_tts</span> <span class="k">as</span> <span class="n">tts</span>
<span class="kn">from</span> <span class="nn">.pyxb_utils</span> <span class="kn">import</span> <span class="n">xml_parsing_context</span><span class="p">,</span> <span class="n">get_xml_parsing_context</span>
<span class="kn">from</span> <span class="nn">.validation.base</span> <span class="kn">import</span> <span class="n">SemanticDocumentMixin</span><span class="p">,</span> <span class="n">SemanticValidationMixin</span><span class="p">,</span> <span class="n">IDMixin</span>
<span class="kn">from</span> <span class="nn">ebu_tt_live.bindings.validation.presentation</span> <span class="kn">import</span> <span class="n">SizingValidationMixin</span><span class="p">,</span> <span class="n">StyledElementMixin</span><span class="p">,</span> <span class="n">RegionedElementMixin</span>
<span class="kn">from</span> <span class="nn">ebu_tt_live.bindings.validation.timing</span> <span class="kn">import</span> <span class="n">TimingValidationMixin</span><span class="p">,</span> <span class="n">BodyTimingValidationMixin</span>
<span class="kn">from</span> <span class="nn">ebu_tt_live.bindings.validation.content</span> <span class="kn">import</span> <span class="n">SubtitleContentContainer</span><span class="p">,</span> <span class="n">ContentContainerMixin</span>
<span class="kn">from</span> <span class="nn">.validation.validator</span> <span class="kn">import</span> <span class="n">SemanticValidator</span>
<span class="kn">from</span> <span class="nn">ebu_tt_live.errors</span> <span class="kn">import</span> <span class="n">SemanticValidationError</span><span class="p">,</span> <span class="n">OutsideSegmentError</span>
<span class="kn">from</span> <span class="nn">ebu_tt_live.strings</span> <span class="kn">import</span> <span class="n">ERR_SEMANTIC_VALIDATION_MISSING_ATTRIBUTES</span><span class="p">,</span> \
    <span class="n">ERR_SEMANTIC_VALIDATION_INVALID_ATTRIBUTES</span><span class="p">,</span> <span class="n">ERR_SEMANTIC_STYLE_CIRCLE</span><span class="p">,</span> <span class="n">ERR_SEMANTIC_STYLE_MISSING</span><span class="p">,</span> \
    <span class="n">ERR_SEMANTIC_ELEMENT_BY_ID_MISSING</span><span class="p">,</span> <span class="n">ERR_SEMANTIC_VALIDATION_EXPECTED</span>
<span class="kn">from</span> <span class="nn">pyxb.exceptions_</span> <span class="kn">import</span> <span class="n">SimpleTypeValueError</span>
<span class="kn">from</span> <span class="nn">pyxb.utils.domutils</span> <span class="kn">import</span> <span class="n">BindingDOMSupport</span>
<span class="kn">from</span> <span class="nn">pyxb.binding.basis</span> <span class="kn">import</span> <span class="n">ElementContent</span><span class="p">,</span> <span class="n">NonElementContent</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">logging</span>


<span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># This mapping controls the namespace aliases used in the generated XML content.</span>
<span class="c1"># Not having these results in default mapping to ns1 ns2 ns3..., which should not be a problem</span>
<span class="c1"># but many downstream tools may have terrible custom XML parsing typically by using regular expressions</span>
<span class="c1"># to find `tt:head` for instance. So controlling these to match the spec namespaces helps interoperability.</span>
<span class="n">namespace_prefix_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;tt&#39;</span><span class="p">:</span> <span class="n">raw</span><span class="o">.</span><span class="n">Namespace</span><span class="p">,</span>
    <span class="s1">&#39;ebuttdt&#39;</span><span class="p">:</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">Namespace</span><span class="p">,</span>
    <span class="s1">&#39;ttp&#39;</span><span class="p">:</span> <span class="n">ttp</span><span class="o">.</span><span class="n">Namespace</span><span class="p">,</span>
    <span class="s1">&#39;tts&#39;</span><span class="p">:</span> <span class="n">tts</span><span class="o">.</span><span class="n">Namespace</span><span class="p">,</span>
    <span class="s1">&#39;ttm&#39;</span><span class="p">:</span> <span class="n">ttm</span><span class="o">.</span><span class="n">Namespace</span><span class="p">,</span>
    <span class="s1">&#39;ebuttm&#39;</span><span class="p">:</span> <span class="n">ebuttm</span><span class="o">.</span><span class="n">Namespace</span><span class="p">,</span>
    <span class="s1">&#39;ebutts&#39;</span><span class="p">:</span> <span class="n">ebutts</span><span class="o">.</span><span class="n">Namespace</span><span class="p">,</span>
    <span class="s1">&#39;ebuttp&#39;</span><span class="p">:</span> <span class="n">ebuttp</span><span class="o">.</span><span class="n">Namespace</span><span class="p">,</span>
    <span class="s1">&#39;ebuttlm&#39;</span><span class="p">:</span> <span class="n">ebuttlm</span><span class="o">.</span><span class="n">Namespace</span>
<span class="p">}</span>


<div class="viewcode-block" id="CreateFromDocument"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.CreateFromDocument">[docs]</a><span class="k">def</span> <span class="nf">CreateFromDocument</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resetting the parsing context on start</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">xml_parsing_context</span><span class="p">():</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">CreateFromDocument</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="CreateFromDOM"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.CreateFromDOM">[docs]</a><span class="k">def</span> <span class="nf">CreateFromDOM</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resetting the parsing context on start</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">xml_parsing_context</span><span class="p">():</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">CreateFromDOM</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span></div>


<span class="c1"># Customizing validation mixins before application</span>
<span class="c1"># ================================================</span>


<div class="viewcode-block" id="style_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.style_type">[docs]</a><span class="k">class</span> <span class="nc">style_type</span><span class="p">(</span><span class="n">StyledElementMixin</span><span class="p">,</span> <span class="n">IDMixin</span><span class="p">,</span> <span class="n">SizingValidationMixin</span><span class="p">,</span> <span class="n">SemanticValidationMixin</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">style</span><span class="p">):</span>

    <span class="c1"># This helps us detecting infinite loops.</span>
    <span class="n">_styling_lock</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># ordered styles cached</span>
    <span class="n">_ordered_styles</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># This mapping is meant to simplify things. In case anything needs special calculation that value should be</span>
    <span class="c1"># lifted out to its own function.</span>
    <span class="n">_simple_attr_defaults</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;backgroundColor&#39;</span><span class="p">:</span> <span class="s1">&#39;transparent&#39;</span><span class="p">,</span>
        <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;0px&#39;</span><span class="p">,</span>
        <span class="s1">&#39;unicodeBidi&#39;</span><span class="p">:</span> <span class="s1">&#39;normal&#39;</span>
    <span class="p">}</span>
    <span class="n">_inherited_attr_defaults</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># See: https://www.w3.org/TR/ttaf1-dfxp/#style-attribute-color</span>
        <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;ltr&#39;</span><span class="p">,</span>
        <span class="s1">&#39;fontFamily&#39;</span><span class="p">:</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span>
        <span class="s1">&#39;fontStyle&#39;</span><span class="p">:</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span>
        <span class="s1">&#39;fontWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span>
        <span class="s1">&#39;linePadding&#39;</span><span class="p">:</span> <span class="s1">&#39;0c&#39;</span><span class="p">,</span>
        <span class="s1">&#39;multiRowAlign&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="s1">&#39;textAlign&#39;</span><span class="p">:</span> <span class="s1">&#39;start&#39;</span><span class="p">,</span>
        <span class="s1">&#39;textDecoration&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
        <span class="s1">&#39;wrapOption&#39;</span><span class="p">:</span> <span class="s1">&#39;wrap&#39;</span>
    <span class="p">}</span>
    <span class="n">_default_attrs</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">u</span><span class="s1">&#39;&lt;style ID: </span><span class="si">{id}</span><span class="s1"> at </span><span class="si">{addr}</span><span class="s1">&gt;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">addr</span><span class="o">=</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_semantic_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="n">copied_style</span> <span class="o">=</span> <span class="n">style_type</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span>  <span class="c1"># there is no ordering requirement in styling so too soon to deconflict here</span>
            <span class="n">direction</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">,</span>
            <span class="n">fontFamily</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fontFamily</span><span class="p">,</span>
            <span class="n">fontSize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fontSize</span><span class="p">,</span>
            <span class="n">lineHeight</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lineHeight</span><span class="p">,</span>
            <span class="n">textAlign</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">textAlign</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">,</span>
            <span class="n">backgroundColor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backgroundColor</span><span class="p">,</span>
            <span class="n">fontStyle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fontStyle</span><span class="p">,</span>
            <span class="n">fontWeight</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fontWeight</span><span class="p">,</span>
            <span class="n">textDecoration</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">textDecoration</span><span class="p">,</span>
            <span class="n">unicodeBidi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unicodeBidi</span><span class="p">,</span>
            <span class="n">wrapOption</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wrapOption</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
            <span class="n">linePadding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">linePadding</span><span class="p">,</span>
            <span class="n">_strict_keywords</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">copied_style</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">validated_styles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># The style element itself is not meant to implement this.</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

<div class="viewcode-block" id="style_type.ordered_styles"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.style_type.ordered_styles">[docs]</a>    <span class="k">def</span> <span class="nf">ordered_styles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function figures out the chain of styles.</span>
<span class="sd">        WARNING: Do not call this before the semantic validation of tt/head/styling is finished. Otherwise your style</span>
<span class="sd">        may not have been found yet!</span>
<span class="sd">        :param dataset: Semantic dataset</span>
<span class="sd">        :return: a list of styles applicable in order</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_styling_lock</span><span class="o">.</span><span class="n">locked</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">SemanticValidationError</span><span class="p">(</span><span class="n">ERR_SEMANTIC_STYLE_CIRCLE</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span>
            <span class="p">))</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_styling_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ordered_styles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ordered_styles</span>
            <span class="n">ordered_styles</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">style_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">style_elem</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;tt_element&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get_element_by_id</span><span class="p">(</span><span class="n">elem_id</span><span class="o">=</span><span class="n">style_id</span><span class="p">,</span> <span class="n">elem_type</span><span class="o">=</span><span class="n">style_type</span><span class="p">)</span>
                        <span class="n">cascading_styles</span> <span class="o">=</span> <span class="n">style_elem</span><span class="o">.</span><span class="n">ordered_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">style_elem</span> <span class="ow">in</span> <span class="n">cascading_styles</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">style_elem</span> <span class="ow">in</span> <span class="n">ordered_styles</span><span class="p">:</span>
                                <span class="k">continue</span>
                            <span class="n">ordered_styles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">style_elem</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">LookupError</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">SemanticValidationError</span><span class="p">(</span><span class="n">ERR_SEMANTIC_STYLE_MISSING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="n">style</span><span class="o">=</span><span class="n">style_id</span>
                        <span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_ordered_styles</span> <span class="o">=</span> <span class="n">ordered_styles</span>
            <span class="k">return</span> <span class="n">ordered_styles</span></div>

<div class="viewcode-block" id="style_type.add"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.style_type.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">direction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">direction</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontFamily</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">fontFamily</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontFamily</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fontFamily</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontSize</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">fontSize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontSize</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fontSize</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineHeight</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">lineHeight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineHeight</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">lineHeight</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">textAlign</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">textAlign</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">textAlign</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">textAlign</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">color</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">backgroundColor</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontStyle</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">fontStyle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontStyle</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fontStyle</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fontWeight</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">fontWeight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fontWeight</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fontWeight</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">textDecoration</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">textDecoration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">textDecoration</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">textDecoration</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unicodeBidi</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">unicodeBidi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unicodeBidi</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">unicodeBidi</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapOption</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">wrapOption</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wrapOption</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">wrapOption</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">padding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">padding</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linePadding</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">linePadding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linePadding</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">linePadding</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">multiRowAlign</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">multiRowAlign</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">multiRowAlign</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">multiRowAlign</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="style_type.resolve_styles"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.style_type.resolve_styles">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">resolve_styles</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">referenced_styles</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resolve the style attributes in inheritance chain</span>
<span class="sd">        :param referenced_styles:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">referenced_styles</span><span class="p">:</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">instance</span></div>

<div class="viewcode-block" id="style_type.compute_font_size"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.style_type.compute_font_size">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">compute_font_size</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">specified_style</span><span class="p">,</span> <span class="n">parent_computed_style</span><span class="p">,</span> <span class="n">region_computed_style</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">defer</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">spec_font_size</span> <span class="o">=</span> <span class="n">specified_style</span><span class="o">.</span><span class="n">fontSize</span>
        <span class="n">default_font_size</span> <span class="o">=</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">CellFontSizeType</span><span class="p">(</span><span class="s1">&#39;1c&#39;</span><span class="p">)</span>
        <span class="n">result_font_size</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">spec_font_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Check relativeness</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec_font_size</span><span class="p">,</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">PercentageFontSizeType</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">parent_computed_style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">parent_computed_style</span><span class="o">.</span><span class="n">fontSize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">result_font_size</span> <span class="o">=</span> <span class="n">parent_computed_style</span><span class="o">.</span><span class="n">fontSize</span> <span class="o">*</span> <span class="n">spec_font_size</span>
                <span class="k">elif</span> <span class="n">region_computed_style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">region_computed_style</span><span class="o">.</span><span class="n">fontSize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">result_font_size</span> <span class="o">=</span> <span class="n">region_computed_style</span><span class="o">.</span><span class="n">fontSize</span> <span class="o">*</span> <span class="n">spec_font_size</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">region_computed_style</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">defer</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="c1"># This is an edge-case. body or div can have styles attached with fontSize but may still have no</span>
                        <span class="c1"># region assigned so if they are percentage based the calculation needs to be deferred.</span>
                        <span class="c1"># In this case and in this case only we save percentage in the computed fontSize value</span>
                        <span class="n">result_font_size</span> <span class="o">=</span> <span class="n">spec_font_size</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># This means the default font size needs to be modulated by the percentage</span>
                        <span class="n">result_font_size</span> <span class="o">=</span> <span class="n">default_font_size</span> <span class="o">*</span> <span class="n">spec_font_size</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result_font_size</span><span class="p">,</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">PercentageFontSizeType</span><span class="p">)</span> <span class="ow">and</span> <span class="n">defer</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="c1"># We cannot defer any longer so now it is time to resolve it.</span>
                    <span class="n">result_font_size</span> <span class="o">*=</span> <span class="n">default_font_size</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># TODO: control the type here</span>
                <span class="n">result_font_size</span> <span class="o">=</span> <span class="n">spec_font_size</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">region_computed_style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">region_computed_style</span><span class="o">.</span><span class="n">fontSize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result_font_size</span> <span class="o">=</span> <span class="n">region_computed_style</span><span class="o">.</span><span class="n">fontSize</span>
            <span class="k">if</span> <span class="n">parent_computed_style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">parent_computed_style</span><span class="o">.</span><span class="n">fontSize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent_computed_style</span><span class="o">.</span><span class="n">fontSize</span><span class="p">,</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">PercentageFontSizeType</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">result_font_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="c1"># There is a region we can proceed</span>
                        <span class="n">result_font_size</span> <span class="o">*=</span> <span class="n">parent_computed_style</span><span class="o">.</span><span class="n">fontSize</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">result_font_size</span> <span class="o">=</span> <span class="n">parent_computed_style</span><span class="o">.</span><span class="n">fontSize</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">result_font_size</span> <span class="o">=</span> <span class="n">parent_computed_style</span><span class="o">.</span><span class="n">fontSize</span>
                <span class="k">if</span> <span class="n">defer</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result_font_size</span><span class="p">,</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">PercentageFontSizeType</span><span class="p">):</span>
                        <span class="n">result_font_size</span> <span class="o">*=</span> <span class="n">default_font_size</span>

        <span class="k">if</span> <span class="n">result_font_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result_font_size</span><span class="p">,</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">pixelFontSizeType</span><span class="p">):</span>
                <span class="n">result_font_size</span> <span class="o">=</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">CellFontSizeType</span><span class="p">(</span>
                    <span class="o">*</span><span class="n">ebuttdt</span><span class="o">.</span><span class="n">pixels_to_cells</span><span class="p">(</span>
                        <span class="n">result_font_size</span><span class="p">,</span>
                        <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;tt_element&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span>
                        <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;tt_element&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cellResolution</span>
                    <span class="p">)</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">defer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">result_font_size</span> <span class="o">=</span> <span class="n">default_font_size</span>

        <span class="k">return</span> <span class="n">result_font_size</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">default_attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This property function gives back a set in which we find the unspecified style attributes.</span>

<span class="sd">            :return: set for attribute names that were inheriting the default in the computed style. Important at</span>
<span class="sd">                     inheritance override</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_attrs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_default_attrs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_attrs</span>

<div class="viewcode-block" id="style_type.set_default_value"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.style_type.set_default_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_default_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># We must cater for the case when default computed values would override specified region style values</span>
        <span class="c1"># With fontSize the defaults are vital for computing relative values. At override the next element down the</span>
        <span class="c1"># line would not be able to tell if the parent computed an actually intended value or just the</span>
        <span class="c1"># inheritance of the default value.</span>
        <span class="k">if</span> <span class="n">default_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_simple_attr_defaults</span><span class="p">:</span>
                <span class="n">default_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_simple_attr_defaults</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inherited_attr_defaults</span><span class="p">:</span>
                <span class="n">default_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inherited_attr_defaults</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">()</span>
        <span class="c1"># This is the extra step: register default value usage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_attrs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">attr_name</span><span class="p">,</span>
            <span class="n">default_value</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="style_type.compute_inherited_attribute"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.style_type.compute_inherited_attribute">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">compute_inherited_attribute</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">specified_style</span><span class="p">,</span> <span class="n">parent_computed_style</span><span class="p">,</span> <span class="n">region_computed_style</span><span class="p">):</span>
        <span class="n">fallback_order</span> <span class="o">=</span> <span class="p">[</span><span class="n">specified_style</span><span class="p">,</span> <span class="n">parent_computed_style</span><span class="p">,</span> <span class="n">region_computed_style</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">fallback_order</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">attr_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">default_attrs</span><span class="p">:</span>
                <span class="n">attr_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">attr_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">attr_value</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="style_type.compute_simple_attribute"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.style_type.compute_simple_attribute">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">compute_simple_attribute</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">specified_style</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">specified_style</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attr_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">specified_style</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">attr_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">attr_value</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="style_type.compute_line_height"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.style_type.compute_line_height">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">compute_line_height</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">specified_style</span><span class="p">,</span> <span class="n">parent_computed_style</span><span class="p">,</span> <span class="n">region_computed_style</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">font_size</span><span class="p">):</span>
        <span class="n">fallback_order</span> <span class="o">=</span> <span class="p">[</span><span class="n">specified_style</span><span class="p">,</span> <span class="n">parent_computed_style</span><span class="p">,</span> <span class="n">region_computed_style</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">fallback_order</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">lineHeight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;lineHeight&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">default_attrs</span><span class="p">:</span>
                <span class="n">selected_value</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">lineHeight</span>
                <span class="c1"># NOTE: the return value should be cell based except when &#39;normal&#39; is used</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selected_value</span><span class="p">,</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">PixelLineHeightType</span><span class="p">):</span>
                    <span class="n">selected_value</span> <span class="o">=</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">CellLineHeightType</span><span class="p">(</span>
                        <span class="o">*</span><span class="n">ebuttdt</span><span class="o">.</span><span class="n">pixels_to_cells</span><span class="p">(</span>
                            <span class="n">selected_value</span><span class="p">,</span>
                            <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;tt_element&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span>
                            <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;tt_element&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cellResolution</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">selected_value</span><span class="p">,</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">PercentageLineHeightType</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">font_size</span><span class="p">,</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">cellFontSizeType</span><span class="p">):</span>
                    <span class="c1"># We only need to deal with this case if fontSize was not deferred</span>
                    <span class="n">selected_value</span> <span class="o">*=</span> <span class="n">font_size</span>

                <span class="k">return</span> <span class="n">selected_value</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="style_type.compute_style"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.style_type.compute_style">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">compute_style</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">specified_style</span><span class="p">,</span> <span class="n">parent_computed_style</span><span class="p">,</span> <span class="n">region_computed_style</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">defer_font_size</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function holds the styling semantics of containers considering direct reference, inheritance and</span>
<span class="sd">        containment variables</span>
<span class="sd">        :param specified_style: Directly referenced resolved styles</span>
<span class="sd">        :param parent_computed_style: Inherited styling information from parent container</span>
<span class="sd">        :param region_computed_style: Default region styling information</span>
<span class="sd">        :param dataset: Semantic dataset needed for conversion context</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">computed</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="c1"># Here we need to check for multiple things for each style attribute:</span>
        <span class="c1"># 1: If specified</span>
        <span class="c1"># 2: If specified value is relative</span>
        <span class="c1"># 3: If not specified and there is parent style attr</span>
        <span class="c1"># 4: If no parent style attr but there is region style attr</span>
        <span class="c1"># 5: If none of the above assume the default</span>

        <span class="n">computed</span><span class="o">.</span><span class="n">fontSize</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">compute_font_size</span><span class="p">(</span>
            <span class="n">specified_style</span><span class="o">=</span><span class="n">specified_style</span><span class="p">,</span>
            <span class="n">parent_computed_style</span><span class="o">=</span><span class="n">parent_computed_style</span><span class="p">,</span>
            <span class="n">region_computed_style</span><span class="o">=</span><span class="n">region_computed_style</span><span class="p">,</span>
            <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
            <span class="n">defer</span><span class="o">=</span><span class="n">defer_font_size</span>
        <span class="p">)</span>
        <span class="n">computed_line_height</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">compute_line_height</span><span class="p">(</span>
            <span class="n">specified_style</span><span class="o">=</span><span class="n">specified_style</span><span class="p">,</span>
            <span class="n">parent_computed_style</span><span class="o">=</span><span class="n">parent_computed_style</span><span class="p">,</span>
            <span class="n">region_computed_style</span><span class="o">=</span><span class="n">region_computed_style</span><span class="p">,</span>
            <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
            <span class="n">font_size</span><span class="o">=</span><span class="n">computed</span><span class="o">.</span><span class="n">fontSize</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">computed_line_height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">computed</span><span class="o">.</span><span class="n">set_default_value</span><span class="p">(</span><span class="s1">&#39;lineHeight&#39;</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">computed</span><span class="o">.</span><span class="n">lineHeight</span> <span class="o">=</span> <span class="n">computed_line_height</span>

        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_simple_attr_defaults</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">comp_attr_value</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">compute_simple_attribute</span><span class="p">(</span>
                <span class="n">attr_name</span><span class="o">=</span><span class="n">attr_name</span><span class="p">,</span>
                <span class="n">specified_style</span><span class="o">=</span><span class="n">specified_style</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">comp_attr_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">computed</span><span class="o">.</span><span class="n">set_default_value</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span>
                    <span class="n">computed</span><span class="p">,</span>
                    <span class="n">attr_name</span><span class="p">,</span>
                    <span class="n">comp_attr_value</span>
                <span class="p">)</span>

        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_inherited_attr_defaults</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">comp_attr_value</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">compute_inherited_attribute</span><span class="p">(</span>
                <span class="n">attr_name</span><span class="o">=</span><span class="n">attr_name</span><span class="p">,</span>
                <span class="n">specified_style</span><span class="o">=</span><span class="n">specified_style</span><span class="p">,</span>
                <span class="n">parent_computed_style</span><span class="o">=</span><span class="n">parent_computed_style</span><span class="p">,</span>
                <span class="n">region_computed_style</span><span class="o">=</span><span class="n">region_computed_style</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">comp_attr_value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">computed</span><span class="o">.</span><span class="n">set_default_value</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span>
                    <span class="n">computed</span><span class="p">,</span>
                    <span class="n">attr_name</span><span class="p">,</span>
                    <span class="n">comp_attr_value</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">computed</span></div>

    <span class="k">def</span> <span class="nf">_semantic_before_traversal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_register_id</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_check_sizing_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fontSize</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_check_sizing_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineHeight</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
        <span class="c1"># Init recursion loop detection lock</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_styling_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ordered_styles</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_semantic_before_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;affected_elements&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">OutsideSegmentError</span><span class="p">()</span></div>

<span class="c1"># For the requirements of the StyledElementMixin</span>
<span class="n">style_type</span><span class="o">.</span><span class="n">_compatible_style_type</span> <span class="o">=</span> <span class="n">style_type</span>
<span class="n">raw</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">style_type</span><span class="p">)</span>


<div class="viewcode-block" id="LiveStyledElementMixin"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.LiveStyledElementMixin">[docs]</a><span class="k">class</span> <span class="nc">LiveStyledElementMixin</span><span class="p">(</span><span class="n">StyledElementMixin</span><span class="p">):</span>

    <span class="n">_compatible_style_type</span> <span class="o">=</span> <span class="n">style_type</span></div>


<span class="c1"># EBU TT Live element types</span>
<span class="c1"># =========================</span>
<span class="c1"># NOTE: Some of the code below includes handling of SMPTE time base, which was removed from version 1.0 of the specification.</span>


<div class="viewcode-block" id="tt_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.tt_type">[docs]</a><span class="k">class</span> <span class="nc">tt_type</span><span class="p">(</span><span class="n">SemanticDocumentMixin</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">tt_type</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__post_time_base_set_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_use</span><span class="p">):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">get_xml_parsing_context</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># This means we are in XML parsing mode</span>
            <span class="n">context</span><span class="p">[</span><span class="s1">&#39;timeBase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeBase</span>

    <span class="n">_attr_en_post</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">(</span><span class="n">pyxb</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">ExpandedName</span><span class="p">(</span><span class="n">ttp</span><span class="o">.</span><span class="n">Namespace</span><span class="p">,</span> <span class="s1">&#39;timeBase&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">uriTuple</span><span class="p">():</span> <span class="n">__post_time_base_set_attribute</span>
    <span class="p">}</span>
    <span class="n">_elements_by_id</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_validator_class</span> <span class="o">=</span> <span class="n">SemanticValidator</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">copied_tt</span> <span class="o">=</span> <span class="n">tt_type</span><span class="p">(</span>
            <span class="n">lang</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="p">,</span>
            <span class="n">extent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span>
            <span class="n">timeBase</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeBase</span><span class="p">,</span>
            <span class="n">frameRate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">frameRate</span><span class="p">,</span>
            <span class="n">frameRateMultiplier</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">frameRateMultiplier</span><span class="p">,</span>
            <span class="n">markerMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">markerMode</span><span class="p">,</span>
            <span class="n">dropMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropMode</span><span class="p">,</span>
            <span class="n">clockMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">clockMode</span><span class="p">,</span>
            <span class="n">cellResolution</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cellResolution</span><span class="p">,</span>
            <span class="n">sequenceIdentifier</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sequenceIdentifier</span><span class="p">,</span>
            <span class="n">sequenceNumber</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sequenceNumber</span><span class="p">,</span>
            <span class="n">authoringDelay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">authoringDelay</span><span class="p">,</span>
            <span class="n">authorsGroupIdentifier</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">authorsGroupIdentifier</span><span class="p">,</span>
            <span class="n">authorsGroupControlToken</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">authorsGroupControlToken</span><span class="p">,</span>
            <span class="n">authorsGroupSelectedSequenceIdentifier</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">authorsGroupSelectedSequenceIdentifier</span><span class="p">,</span>
            <span class="n">referenceClockIdentifier</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">referenceClockIdentifier</span><span class="p">,</span>
            <span class="n">_strict_keywords</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">copied_tt</span>

<div class="viewcode-block" id="tt_type.merge"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.tt_type.merge">[docs]</a>    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="c1"># TODO: compatibility check, rules of merging TBD</span>
        <span class="c1"># merged_tt = tt_type(</span>
        <span class="c1">#     lang=self.lang,</span>
        <span class="c1">#     extent=self.extent,</span>
        <span class="c1">#     timeBase=self.timeBase,</span>
        <span class="c1">#     frameRate=self.frameRate,</span>
        <span class="c1">#     frameRateMultiplier=self.frameRateMultiplier,</span>
        <span class="c1">#     markerMode=self.markerMode,</span>
        <span class="c1">#     dropMode=self.dropMode,</span>
        <span class="c1">#     clockMode=self.clockMode,</span>
        <span class="c1">#     cellResolution=self.cellResolution,</span>
        <span class="c1">#     sequenceIdentifier=self.sequenceIdentifier,</span>
        <span class="c1">#     sequenceNumber=self.sequenceNumber,</span>
        <span class="c1">#     authoringDelay=self.authoringDelay,</span>
        <span class="c1">#     authorsGroupIdentifier=self.authorsGroupIdentifier,</span>
        <span class="c1">#     authorsGroupControlToken=self.authorsGroupControlToken,</span>
        <span class="c1">#     authorsGroupControlRequest=self.authorsGroupControlRequest,</span>
        <span class="c1">#     referenceClockIdentifier=self.referenceClockIdentifier,</span>
        <span class="c1">#     _strict_keywords=False</span>
        <span class="c1"># )</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">__check_bds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bds</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bds</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">bds</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BindingDOMSupport</span><span class="p">(</span>
                <span class="n">namespace_prefix_map</span><span class="o">=</span><span class="n">namespace_prefix_map</span>
            <span class="p">)</span>

<div class="viewcode-block" id="tt_type.toDOM"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.tt_type.toDOM">[docs]</a>    <span class="k">def</span> <span class="nf">toDOM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">element_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">tt_type</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">toDOM</span><span class="p">(</span>
            <span class="n">bds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__check_bds</span><span class="p">(</span><span class="n">bds</span><span class="p">),</span>
            <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
            <span class="n">element_name</span><span class="o">=</span><span class="n">element_name</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="tt_type.toxml"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.tt_type.toxml">[docs]</a>    <span class="k">def</span> <span class="nf">toxml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">root_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">element_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">dom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toDOM</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__check_bds</span><span class="p">(</span><span class="n">bds</span><span class="p">),</span> <span class="n">element_name</span><span class="o">=</span><span class="n">element_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">root_only</span><span class="p">:</span>
            <span class="n">dom</span> <span class="o">=</span> <span class="n">dom</span><span class="o">.</span><span class="n">documentElement</span>
        <span class="k">return</span> <span class="n">dom</span><span class="o">.</span><span class="n">toprettyxml</span><span class="p">(</span>
            <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span>
            <span class="n">indent</span><span class="o">=</span><span class="s1">&#39;  &#39;</span>
        <span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_semantic_after_subtree_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">copied_instance</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># This one does not have another parent to link with but it can make itself an element</span>
        <span class="n">copied_instance</span><span class="o">.</span><span class="n">_setElement</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">tt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__semantic_test_smpte_attrs_present</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">smpte_attrs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;frameRate&#39;</span><span class="p">,</span>
            <span class="c1"># &#39;frameRateMultiplier&#39;,</span>
            <span class="s1">&#39;dropMode&#39;</span><span class="p">,</span>
            <span class="s1">&#39;markerMode&#39;</span>
        <span class="p">]</span>
        <span class="n">missing_attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_attributes_missing</span><span class="p">(</span><span class="n">smpte_attrs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">missing_attrs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SemanticValidationError</span><span class="p">(</span>
                <span class="n">ERR_SEMANTIC_VALIDATION_MISSING_ATTRIBUTES</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">elem_name</span><span class="o">=</span><span class="s1">&#39;tt:tt&#39;</span><span class="p">,</span>
                    <span class="n">attr_names</span><span class="o">=</span><span class="n">missing_attrs</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__semantic_test_smpte_attrs_absent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">smpte_attrs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;dropMode&#39;</span><span class="p">,</span>
            <span class="s1">&#39;markerMode&#39;</span>
        <span class="p">]</span>
        <span class="n">extra_attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_attributes_present</span><span class="p">(</span><span class="n">smpte_attrs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extra_attrs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SemanticValidationError</span><span class="p">(</span>
                <span class="n">ERR_SEMANTIC_VALIDATION_INVALID_ATTRIBUTES</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">elem_name</span><span class="o">=</span><span class="s1">&#39;tt:tt&#39;</span><span class="p">,</span>
                    <span class="n">attr_names</span><span class="o">=</span><span class="n">extra_attrs</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__semantic_test_time_base_clock_attrs_present</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">clock_attrs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;clockMode&#39;</span>
        <span class="p">]</span>
        <span class="n">missing_attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_attributes_missing</span><span class="p">(</span><span class="n">clock_attrs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">missing_attrs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SemanticValidationError</span><span class="p">(</span>
                <span class="n">ERR_SEMANTIC_VALIDATION_MISSING_ATTRIBUTES</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">elem_name</span><span class="o">=</span><span class="s1">&#39;tt:tt&#39;</span><span class="p">,</span>
                    <span class="n">attr_names</span><span class="o">=</span><span class="n">missing_attrs</span>
                <span class="p">)</span>
            <span class="p">)</span>


    <span class="k">def</span> <span class="nf">__semantic_test_time_base_clock_attrs_absent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">clock_attrs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;clockMode&#39;</span>
        <span class="p">]</span>
        <span class="n">extra_attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_attributes_present</span><span class="p">(</span><span class="n">clock_attrs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extra_attrs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SemanticValidationError</span><span class="p">(</span>
                <span class="n">ERR_SEMANTIC_VALIDATION_MISSING_ATTRIBUTES</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">elem_name</span><span class="o">=</span><span class="s1">&#39;tt:tt&#39;</span><span class="p">,</span>
                    <span class="n">attr_names</span><span class="o">=</span><span class="n">extra_attrs</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__semantic_test_smpte_attr_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TODO: SMPTE validation(low priority) #52</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_semantic_before_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Here before anything semantic happens I check some SYNTACTIC errors.</span>
<span class="sd">        :raises ComplexTypeValidationError, SimpleTypeValueError</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The following edge case is ruined by the XSD associating the same extent type to this extent element.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">pixelExtentType</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SimpleTypeValueError</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extent</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">extent</span><span class="p">)</span>
        <span class="c1"># This little gem is correcting a bug in PyXB and defult attribute values being instantiated to the old type</span>
        <span class="c1"># and not the customized one</span>
        <span class="c1"># e.g: instead of ebuttdt.CellResolutionType it creates raw._ebuttdt.cellResolutionType, which is a bug</span>
        <span class="c1"># NOTE: As a side effect however this monkey patch will cause cellResolution to be defined on all generated</span>
        <span class="c1"># documents&#39; tt element.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cellResolution</span><span class="p">,</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">cellResolutionType</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cellResolution</span> <span class="o">=</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">CellResolutionType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cellResolution</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_semantic_before_traversal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># The tt element adds itself to the semantic dataset to help classes lower down the line to locate constraining</span>
        <span class="c1"># attributes.</span>
        <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;timing_begin_stack&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;timing_end_stack&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;timing_syncbase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">()</span>
        <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;tt_element&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;styles_stack&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elements_by_id</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;elements_by_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements_by_id</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeBase</span> <span class="o">==</span> <span class="s1">&#39;smpte&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__semantic_test_smpte_attrs_present</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__semantic_test_smpte_attrs_absent</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeBase</span> <span class="o">==</span> <span class="s1">&#39;clock&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__semantic_test_time_base_clock_attrs_present</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__semantic_test_time_base_clock_attrs_absent</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_semantic_after_traversal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Save this for id lookup.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elements_by_id</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;elements_by_id&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="tt_type.get_element_by_id"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.tt_type.get_element_by_id">[docs]</a>    <span class="k">def</span> <span class="nf">get_element_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem_id</span><span class="p">,</span> <span class="n">elem_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lookup an element and return it. Optionally type is checked as well.</span>
<span class="sd">        :param elem_id:</span>
<span class="sd">        :param elem_type:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements_by_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SemanticValidationError</span><span class="p">(</span><span class="n">ERR_SEMANTIC_VALIDATION_EXPECTED</span><span class="p">)</span>
        <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements_by_id</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">elem_id</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">element</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">elem_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">elem_type</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">LookupError</span><span class="p">(</span><span class="n">ERR_SEMANTIC_ELEMENT_BY_ID_MISSING</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">elem_id</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">element</span></div>

<div class="viewcode-block" id="tt_type.get_timing_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.tt_type.get_timing_type">[docs]</a>    <span class="k">def</span> <span class="nf">get_timing_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timedelta_in</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeBase</span> <span class="o">==</span> <span class="s1">&#39;clock&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">LimitedClockTimingType</span><span class="p">(</span><span class="n">timedelta_in</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeBase</span> <span class="o">==</span> <span class="s1">&#39;media&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">FullClockTimingType</span><span class="p">(</span><span class="n">timedelta_in</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeBase</span> <span class="o">==</span> <span class="s1">&#39;smpte&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ebuttdt</span><span class="o">.</span><span class="n">SMPTETimingType</span><span class="p">(</span><span class="n">timedelta_in</span><span class="p">)</span></div></div>

<span class="n">raw</span><span class="o">.</span><span class="n">tt_type</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">tt_type</span><span class="p">)</span>


<span class="c1"># Head classes</span>
<span class="c1"># ============</span>


<div class="viewcode-block" id="head_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.head_type">[docs]</a><span class="k">class</span> <span class="nc">head_type</span><span class="p">(</span><span class="n">SemanticValidationMixin</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">head_type</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">copied_head</span> <span class="o">=</span> <span class="n">head_type</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">copied_head</span>

<div class="viewcode-block" id="head_type.merge"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.head_type.merge">[docs]</a>    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_elem</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span></div></div>

<span class="n">raw</span><span class="o">.</span><span class="n">head_type</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">head_type</span><span class="p">)</span>


<span class="c1"># Body classes</span>
<span class="c1"># ============</span>


<div class="viewcode-block" id="p_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.p_type">[docs]</a><span class="k">class</span> <span class="nc">p_type</span><span class="p">(</span><span class="n">RegionedElementMixin</span><span class="p">,</span> <span class="n">LiveStyledElementMixin</span><span class="p">,</span> <span class="n">SubtitleContentContainer</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">p_type</span><span class="p">):</span>

    <span class="n">_attr_en_pre</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">(</span><span class="n">pyxb</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">ExpandedName</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;begin&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">uriTuple</span><span class="p">():</span> <span class="n">TimingValidationMixin</span><span class="o">.</span><span class="n">_pre_timing_set_attribute</span><span class="p">,</span>
        <span class="p">(</span><span class="n">pyxb</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">ExpandedName</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">uriTuple</span><span class="p">():</span> <span class="n">TimingValidationMixin</span><span class="o">.</span><span class="n">_pre_timing_set_attribute</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_semantic_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="n">copied_p</span> <span class="o">=</span> <span class="n">p_type</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">space</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">,</span>
            <span class="n">lang</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="p">,</span>
            <span class="n">region</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_semantic_deconflicted_ids</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">),</span>
            <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_semantic_deconflicted_ids</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">),</span>
            <span class="n">begin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span>
            <span class="n">end</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
            <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">role</span><span class="p">,</span>
            <span class="n">_strict_keywords</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">copied_p</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">copied_p</span> <span class="o">=</span> <span class="n">p_type</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">space</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">,</span>
            <span class="n">lang</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="p">,</span>
            <span class="n">region</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span>
            <span class="n">begin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span>
            <span class="n">end</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
            <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">role</span><span class="p">,</span>
            <span class="n">_strict_keywords</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">copied_p</span>

    <span class="k">def</span> <span class="nf">_semantic_before_traversal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_register_id</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_timebase_validation</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_preprocess_timing</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_set_region</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">region_type</span><span class="o">=</span><span class="n">region_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_collect_applicable_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">style_type</span><span class="o">=</span><span class="n">style_type</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="n">parent_binding</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_push_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_semantic_after_traversal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_postprocess_timing</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_manage_timeline</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_unset_region</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_pop_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_semantic_before_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_in_segment</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>

<div class="viewcode-block" id="p_type.is_timed_leaf"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.p_type.is_timed_leaf">[docs]</a>    <span class="k">def</span> <span class="nf">is_timed_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">span</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span></div>

    <span class="k">def</span> <span class="nf">_semantic_after_subtree_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">copied_instance</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">copied_instance</span><span class="o">.</span><span class="n">_assert_empty_container</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_copy_apply_leaf_timing</span><span class="p">(</span>
            <span class="n">copied_instance</span><span class="o">=</span><span class="n">copied_instance</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_copy_verify_referenced_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_copy_verify_referenced_region</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span></div>


<span class="n">raw</span><span class="o">.</span><span class="n">p_type</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">p_type</span><span class="p">)</span>


<div class="viewcode-block" id="span_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.span_type">[docs]</a><span class="k">class</span> <span class="nc">span_type</span><span class="p">(</span><span class="n">LiveStyledElementMixin</span><span class="p">,</span> <span class="n">SubtitleContentContainer</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">span_type</span><span class="p">):</span>

    <span class="n">_attr_en_pre</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">(</span><span class="n">pyxb</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">ExpandedName</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;begin&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">uriTuple</span><span class="p">():</span> <span class="n">TimingValidationMixin</span><span class="o">.</span><span class="n">_pre_timing_set_attribute</span><span class="p">,</span>
        <span class="p">(</span><span class="n">pyxb</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">ExpandedName</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">uriTuple</span><span class="p">():</span> <span class="n">TimingValidationMixin</span><span class="o">.</span><span class="n">_pre_timing_set_attribute</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_semantic_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="n">copied_span</span> <span class="o">=</span> <span class="n">span_type</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_semantic_deconflicted_ids</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">),</span>
            <span class="n">begin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span>
            <span class="n">end</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
            <span class="n">space</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">,</span>
            <span class="n">lang</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="p">,</span>
            <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">role</span><span class="p">,</span>
            <span class="n">_strict_keywords</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">copied_span</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">copied_span</span> <span class="o">=</span> <span class="n">span_type</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span>
            <span class="n">begin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span>
            <span class="n">end</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
            <span class="n">space</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">,</span>
            <span class="n">lang</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lang</span><span class="p">,</span>
            <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">role</span><span class="p">,</span>
            <span class="n">_strict_keywords</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">copied_span</span>

    <span class="k">def</span> <span class="nf">_semantic_before_traversal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_register_id</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_timebase_validation</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_preprocess_timing</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_collect_applicable_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">style_type</span><span class="o">=</span><span class="n">style_type</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="n">parent_binding</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_push_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_semantic_after_traversal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_postprocess_timing</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_manage_timeline</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_pop_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_semantic_before_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_in_segment</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>

<div class="viewcode-block" id="span_type.is_timed_leaf"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.span_type.is_timed_leaf">[docs]</a>    <span class="k">def</span> <span class="nf">is_timed_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">span</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span></div>

    <span class="k">def</span> <span class="nf">_semantic_after_subtree_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">copied_instance</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">copied_instance</span><span class="o">.</span><span class="n">_assert_empty_container</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_copy_apply_leaf_timing</span><span class="p">(</span>
            <span class="n">copied_instance</span><span class="o">=</span><span class="n">copied_instance</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_copy_verify_referenced_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span></div>

<span class="n">raw</span><span class="o">.</span><span class="n">span_type</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">span_type</span><span class="p">)</span>


<div class="viewcode-block" id="br_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.br_type">[docs]</a><span class="k">class</span> <span class="nc">br_type</span><span class="p">(</span><span class="n">SemanticValidationMixin</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">br_type</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">br_type</span><span class="p">()</span>

<div class="viewcode-block" id="br_type.content_to_string"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.br_type.content_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">content_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">begin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;br /&gt;&#39;</span></div></div>


<span class="n">raw</span><span class="o">.</span><span class="n">br_type</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">br_type</span><span class="p">)</span>

<div class="viewcode-block" id="div_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.div_type">[docs]</a><span class="k">class</span> <span class="nc">div_type</span><span class="p">(</span><span class="n">ContentContainerMixin</span><span class="p">,</span> <span class="n">IDMixin</span><span class="p">,</span> <span class="n">RegionedElementMixin</span><span class="p">,</span> <span class="n">LiveStyledElementMixin</span><span class="p">,</span> <span class="n">TimingValidationMixin</span><span class="p">,</span>
               <span class="n">SemanticValidationMixin</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">div_type</span><span class="p">):</span>

    <span class="n">_attr_en_pre</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">(</span><span class="n">pyxb</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">ExpandedName</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;begin&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">uriTuple</span><span class="p">():</span> <span class="n">TimingValidationMixin</span><span class="o">.</span><span class="n">_pre_timing_set_attribute</span><span class="p">,</span>
        <span class="p">(</span><span class="n">pyxb</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">ExpandedName</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">uriTuple</span><span class="p">():</span> <span class="n">TimingValidationMixin</span><span class="o">.</span><span class="n">_pre_timing_set_attribute</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_semantic_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="n">copied_div</span> <span class="o">=</span> <span class="n">div_type</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">region</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_semantic_deconflicted_ids</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">),</span>
            <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_semantic_deconflicted_ids</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">),</span>
            <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">role</span><span class="p">,</span>
            <span class="n">begin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span>
            <span class="n">end</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
            <span class="n">_strict_keywords</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">copied_div</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">copied_div</span> <span class="o">=</span> <span class="n">div_type</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">region</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span>
            <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">role</span><span class="p">,</span>
            <span class="n">begin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span>
            <span class="n">end</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
            <span class="n">_strict_keywords</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">copied_div</span>

    <span class="k">def</span> <span class="nf">_semantic_before_traversal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_register_id</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_timebase_validation</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_preprocess_timing</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_set_region</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">region_type</span><span class="o">=</span><span class="n">region_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_collect_applicable_styles</span><span class="p">(</span>
            <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">style_type</span><span class="o">=</span><span class="n">style_type</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="n">parent_binding</span><span class="p">,</span> <span class="n">defer_font_size</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_push_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_semantic_after_traversal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_postprocess_timing</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_unset_region</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_semantic_before_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_in_segment</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>

<div class="viewcode-block" id="div_type.is_empty"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.div_type.is_empty">[docs]</a>    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">div</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="k">def</span> <span class="nf">_semantic_after_subtree_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">copied_instance</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">copied_instance</span><span class="o">.</span><span class="n">_assert_empty_container</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_copy_apply_leaf_timing</span><span class="p">(</span>
            <span class="n">copied_instance</span><span class="o">=</span><span class="n">copied_instance</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_copy_verify_referenced_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_copy_verify_referenced_region</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span></div>


<span class="n">raw</span><span class="o">.</span><span class="n">div_type</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">div_type</span><span class="p">)</span>


<div class="viewcode-block" id="body_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.body_type">[docs]</a><span class="k">class</span> <span class="nc">body_type</span><span class="p">(</span><span class="n">LiveStyledElementMixin</span><span class="p">,</span> <span class="n">BodyTimingValidationMixin</span><span class="p">,</span> <span class="n">SemanticValidationMixin</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">body_type</span><span class="p">):</span>

    <span class="n">_attr_en_pre</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">(</span><span class="n">pyxb</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">ExpandedName</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;begin&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">uriTuple</span><span class="p">():</span> <span class="n">BodyTimingValidationMixin</span><span class="o">.</span><span class="n">_pre_timing_set_attribute</span><span class="p">,</span>
        <span class="p">(</span><span class="n">pyxb</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">ExpandedName</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;dur&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">uriTuple</span><span class="p">():</span> <span class="n">BodyTimingValidationMixin</span><span class="o">.</span><span class="n">_pre_timing_set_attribute</span><span class="p">,</span>
        <span class="p">(</span><span class="n">pyxb</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">ExpandedName</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">uriTuple</span><span class="p">():</span> <span class="n">BodyTimingValidationMixin</span><span class="o">.</span><span class="n">_pre_timing_set_attribute</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_semantic_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="n">copied_body</span> <span class="o">=</span> <span class="n">body_type</span><span class="p">(</span>
            <span class="n">agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">role</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">role</span><span class="p">,</span>
            <span class="n">begin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span>
            <span class="n">dur</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dur</span><span class="p">,</span>
            <span class="n">end</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_semantic_deconflicted_ids</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">),</span>
            <span class="n">_strict_keywords</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">copied_body</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">copied_body</span> <span class="o">=</span> <span class="n">body_type</span><span class="p">(</span>
            <span class="n">agent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">role</span><span class="p">,</span>
            <span class="n">begin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">begin</span><span class="p">,</span>
            <span class="n">dur</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dur</span><span class="p">,</span>
            <span class="n">end</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span>
            <span class="n">_strict_keywords</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">copied_body</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_merge_deconflict_ids</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">ids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deconflict ids of body elements</span>
<span class="sd">        :param element:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">children</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">orderedContent</span><span class="p">()</span>

        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;processing child: </span><span class="si">{}</span><span class="s1"> of </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">element</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">NonElementContent</span><span class="p">):</span>
                <span class="n">copied_stuff</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copied_stuff</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">ElementContent</span><span class="p">):</span>
                <span class="n">copied_elem</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="n">copied_elem</span><span class="o">.</span><span class="n">_resetContent</span><span class="p">()</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">_merge_deconflict_ids</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">copied_elem</span><span class="p">,</span> <span class="n">ids</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">copied_elem</span><span class="p">,</span> <span class="n">IDMixin</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">copied_elem</span><span class="o">.</span><span class="n">id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">copied_elem</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
                        <span class="n">next_try</span> <span class="o">=</span> <span class="n">copied_elem</span><span class="o">.</span><span class="n">id</span>
                        <span class="k">while</span> <span class="n">next_try</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
                            <span class="n">next_try</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">next_try</span><span class="p">)</span>
                        <span class="n">copied_elem</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">next_try</span>
                    <span class="n">ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">copied_elem</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copied_elem</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">output</span><span class="p">:</span>
            <span class="n">dest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dest</span>

<div class="viewcode-block" id="body_type.merge"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.body_type.merge">[docs]</a>    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_elem</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># TODO: Sort out timing and styling merging rules</span>
        <span class="n">merged_body</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">merged_body</span><span class="o">.</span><span class="n">begin</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">merged_body</span><span class="o">.</span><span class="n">dur</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">merged_body</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># The same recursive ID collision issue... DAMN!</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;ids&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_merge_deconflict_ids</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="n">merged_body</span><span class="p">,</span> <span class="n">ids</span><span class="o">=</span><span class="n">ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_merge_deconflict_ids</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="n">other_elem</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="n">merged_body</span><span class="p">,</span> <span class="n">ids</span><span class="o">=</span><span class="n">ids</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">merged_body</span></div>

    <span class="k">def</span> <span class="nf">_semantic_before_traversal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_timebase_validation</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_preprocess_timing</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_collect_applicable_styles</span><span class="p">(</span>
            <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">style_type</span><span class="o">=</span><span class="n">style_type</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="n">parent_binding</span><span class="p">,</span> <span class="n">defer_font_size</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_push_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_semantic_after_traversal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_postprocess_timing</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_pop_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_semantic_before_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_in_segment</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_semantic_after_subtree_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">copied_instance</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_copy_apply_leaf_timing</span><span class="p">(</span>
            <span class="n">copied_instance</span><span class="o">=</span><span class="n">copied_instance</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="n">element_content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_copy_verify_referenced_styles</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span></div>


<span class="n">raw</span><span class="o">.</span><span class="n">body_type</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">body_type</span><span class="p">)</span>


<div class="viewcode-block" id="styling"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.styling">[docs]</a><span class="k">class</span> <span class="nc">styling</span><span class="p">(</span><span class="n">SemanticValidationMixin</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">styling</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">copied_styling</span> <span class="o">=</span> <span class="n">styling</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">copied_styling</span>

<div class="viewcode-block" id="styling.merge"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.styling.merge">[docs]</a>    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_elem</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="n">style_ids</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;ids&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedContent</span><span class="p">():</span>
            <span class="n">style_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other_elem</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">other_elem</span><span class="o">.</span><span class="n">orderedContent</span><span class="p">():</span>
                <span class="n">copied_style</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">style_ids</span><span class="p">:</span>
                    <span class="n">copied_style</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">copied_style</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copied_style</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="k">def</span> <span class="nf">_semantic_after_subtree_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">copied_instance</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># The styles are not ordered by inheritance so they need an extra step here</span>
        <span class="c1"># to get their style ID resolutions sorted</span>
        <span class="k">for</span> <span class="n">style_elem</span> <span class="ow">in</span> \
                <span class="p">[</span>
                    <span class="n">item</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedContent</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">ElementContent</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">style_type</span><span class="p">)</span>
                <span class="p">]:</span>
            <span class="n">copied_style_elem</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;instance_mapping&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">style_elem</span><span class="p">)</span>
            <span class="c1"># The style may not have been copied at all because it isn&#39;t used in the requested segment</span>
            <span class="k">if</span> <span class="n">copied_style_elem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">style_elem_styles</span> <span class="o">=</span> <span class="n">style_elem</span><span class="o">.</span><span class="n">_semantic_deconflicted_ids</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">style_elem_styles</span><span class="p">:</span>
                    <span class="n">copied_style_elem</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">style_elem_styles</span></div>


<span class="n">raw</span><span class="o">.</span><span class="n">styling</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">styling</span><span class="p">)</span>


<div class="viewcode-block" id="region_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.region_type">[docs]</a><span class="k">class</span> <span class="nc">region_type</span><span class="p">(</span><span class="n">IDMixin</span><span class="p">,</span> <span class="n">LiveStyledElementMixin</span><span class="p">,</span> <span class="n">SizingValidationMixin</span><span class="p">,</span> <span class="n">SemanticValidationMixin</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">region</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_semantic_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="n">copied_region</span> <span class="o">=</span> <span class="n">region_type</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">origin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">origin</span><span class="p">,</span>
            <span class="n">extent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_semantic_deconflicted_ids</span><span class="p">(</span><span class="n">attr_name</span><span class="o">=</span><span class="s1">&#39;style&#39;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">),</span>
            <span class="n">displayAlign</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">displayAlign</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
            <span class="n">writingMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">writingMode</span><span class="p">,</span>
            <span class="n">showBackground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">showBackground</span><span class="p">,</span>
            <span class="n">overflow</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">overflow</span><span class="p">,</span>
            <span class="n">_strict_keywords</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">copied_region</span>

    <span class="k">def</span> <span class="nf">_semantic_before_traversal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent_binding</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_register_id</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_check_sizing_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">origin</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_check_sizing_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_semantic_collect_applicable_styles</span><span class="p">(</span>
            <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
            <span class="n">style_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_compatible_style_type</span><span class="p">,</span>
            <span class="n">parent_binding</span><span class="o">=</span><span class="n">parent_binding</span><span class="p">,</span>
            <span class="n">extra_referenced_styles</span><span class="o">=</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_compatible_style_type</span><span class="p">(</span>
                    <span class="n">padding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">padding</span><span class="p">,</span>
                    <span class="n">_strict_keywords</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_semantic_before_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">element_content</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;affected_elements&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">OutsideSegmentError</span><span class="p">()</span></div>


<span class="n">raw</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">region_type</span><span class="p">)</span>


<div class="viewcode-block" id="layout"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.layout">[docs]</a><span class="k">class</span> <span class="nc">layout</span><span class="p">(</span><span class="n">SemanticValidationMixin</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">layout</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">copied_layout</span> <span class="o">=</span> <span class="n">layout</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">copied_layout</span>

<div class="viewcode-block" id="layout.merge"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.layout.merge">[docs]</a>    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_elem</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
        <span class="n">region_ids</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s1">&#39;ids&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orderedContent</span><span class="p">():</span>
            <span class="n">region_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other_elem</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">other_elem</span><span class="o">.</span><span class="n">orderedContent</span><span class="p">():</span>
                <span class="n">copied_region</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">copied_region</span><span class="o">.</span><span class="n">id</span> <span class="ow">in</span> <span class="n">region_ids</span><span class="p">:</span>
                    <span class="n">copied_region</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">copied_region</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                    <span class="n">region_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">copied_region</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copied_region</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div></div>


<span class="n">raw</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>

<span class="c1"># EBU TT D classes</span>
<span class="c1"># ================</span>

<div class="viewcode-block" id="d_tt_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.d_tt_type">[docs]</a><span class="k">class</span> <span class="nc">d_tt_type</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">d_tt_type</span><span class="p">):</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">__check_bds</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bds</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bds</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">bds</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BindingDOMSupport</span><span class="p">(</span>
                <span class="n">namespace_prefix_map</span><span class="o">=</span><span class="n">namespace_prefix_map</span>
            <span class="p">)</span>

<div class="viewcode-block" id="d_tt_type.toDOM"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.d_tt_type.toDOM">[docs]</a>    <span class="k">def</span> <span class="nf">toDOM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">element_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">bds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__check_bds</span><span class="p">(</span><span class="n">bds</span><span class="p">)</span>
        <span class="n">xml_dom</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">d_tt_type</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">toDOM</span><span class="p">(</span>
            <span class="n">bds</span><span class="o">=</span><span class="n">bds</span><span class="p">,</span>
            <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
            <span class="n">element_name</span><span class="o">=</span><span class="n">element_name</span>
        <span class="p">)</span>
        <span class="c1"># Nasty workaround for the namespace collision EBU-TT-D and EBU-TT Live are causing by both defining the same</span>
        <span class="c1"># tt element in the ttml namespace</span>
        <span class="k">if</span> <span class="n">bds</span><span class="o">.</span><span class="n">defaultNamespace</span><span class="p">()</span> <span class="o">!=</span> <span class="n">Namespace</span><span class="p">:</span>
            <span class="n">xml_dom</span><span class="o">.</span><span class="n">documentElement</span><span class="o">.</span><span class="n">tagName</span> <span class="o">=</span> <span class="s1">&#39;tt:tt&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xml_dom</span><span class="o">.</span><span class="n">documentElement</span><span class="o">.</span><span class="n">tagName</span> <span class="o">=</span> <span class="s1">&#39;tt&#39;</span>
        <span class="k">return</span> <span class="n">xml_dom</span></div>

<div class="viewcode-block" id="d_tt_type.toxml"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.d_tt_type.toxml">[docs]</a>    <span class="k">def</span> <span class="nf">toxml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">root_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">element_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">dom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toDOM</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__check_bds</span><span class="p">(</span><span class="n">bds</span><span class="p">),</span> <span class="n">element_name</span><span class="o">=</span><span class="n">element_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">root_only</span><span class="p">:</span>
            <span class="n">dom</span> <span class="o">=</span> <span class="n">dom</span><span class="o">.</span><span class="n">documentElement</span>
        <span class="k">return</span> <span class="n">dom</span><span class="o">.</span><span class="n">toprettyxml</span><span class="p">(</span>
            <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span>
            <span class="n">indent</span><span class="o">=</span><span class="s1">&#39;  &#39;</span>
        <span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_validateBinding_vx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeBase</span> <span class="o">!=</span> <span class="s1">&#39;media&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SimpleTypeValueError</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timeBase</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeBase</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">d_tt_type</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_validateBinding_vx</span><span class="p">()</span></div>


<span class="n">raw</span><span class="o">.</span><span class="n">d_tt_type</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">d_tt_type</span><span class="p">)</span>


<div class="viewcode-block" id="d_layout_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.d_layout_type">[docs]</a><span class="k">class</span> <span class="nc">d_layout_type</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">d_layout_type</span><span class="p">):</span>

<div class="viewcode-block" id="d_layout_type.create_default_value"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.d_layout_type.create_default_value">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create_default_value</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">d_region_type</span><span class="o">.</span><span class="n">create_default_value</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">instance</span></div></div>

<span class="n">raw</span><span class="o">.</span><span class="n">d_layout_type</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">d_layout_type</span><span class="p">)</span>


<div class="viewcode-block" id="d_region_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.d_region_type">[docs]</a><span class="k">class</span> <span class="nc">d_region_type</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">d_region_type</span><span class="p">):</span>

<div class="viewcode-block" id="d_region_type.create_default_value"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.d_region_type.create_default_value">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create_default_value</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;region.default&#39;</span><span class="p">,</span>
            <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;0</span><span class="si">% 0%</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">extent</span><span class="o">=</span><span class="s1">&#39;100</span><span class="si">% 100%</span><span class="s1">&#39;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">instance</span></div></div>

<span class="n">raw</span><span class="o">.</span><span class="n">d_region_type</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">d_region_type</span><span class="p">)</span>


<div class="viewcode-block" id="d_styling_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.d_styling_type">[docs]</a><span class="k">class</span> <span class="nc">d_styling_type</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">d_styling_type</span><span class="p">):</span>

<div class="viewcode-block" id="d_styling_type.create_default_value"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.d_styling_type.create_default_value">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create_default_value</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">d_style_type</span><span class="o">.</span><span class="n">create_default_value</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">instance</span></div></div>

<span class="n">raw</span><span class="o">.</span><span class="n">d_styling_type</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">d_styling_type</span><span class="p">)</span>


<div class="viewcode-block" id="d_style_type"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.d_style_type">[docs]</a><span class="k">class</span> <span class="nc">d_style_type</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">d_style_type</span><span class="p">):</span>

<div class="viewcode-block" id="d_style_type.create_default_value"><a class="viewcode-back" href="../../ebu_tt_live.bindings.html#ebu_tt_live.bindings.d_style_type.create_default_value">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create_default_value</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;style.default&#39;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">instance</span></div></div>

<span class="n">raw</span><span class="o">.</span><span class="n">d_style_type</span><span class="o">.</span><span class="n">_SetSupersedingClass</span><span class="p">(</span><span class="n">d_style_type</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017, European Broadcasting Union

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>